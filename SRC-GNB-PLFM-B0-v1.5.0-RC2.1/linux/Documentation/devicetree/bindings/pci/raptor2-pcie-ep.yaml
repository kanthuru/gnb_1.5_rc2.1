# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/pci/raptor2-pcie-ep.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Raptor2 PCI Endpoint Controller Schema

description: |
  This YAML file describes the device tree binding for the Raptor2 PCIe Endpoint.

maintainers:
  - Aman Sharma <aman.Sharma@edgeq.io>
  - Aakash Verma <aakash.verma@edgeq.io>

properties:
  $nodename:
    pattern: "^raptor2-pcie-ep@"


  reg:
    maxItems: 6
    items:
      - description: IP reg 1 DBI
      - description: IP reg 2 DBI2
      - description: IP reg ATU
      - description: Config space
      - description: Port Bringup Configuration
      - description: Link4 Configuration

  reg-names:
    items:
      - const: "dbi"
      - const: "dbi2"
      - const: "atu"
      - const: "addr_space"
      - const: "br_up"
      - const: "lk_reg"

  dma-coherent: true

  num-lanes:
    description: Maximum number of functions that can be configured
    $ref: /schemas/types.yaml#/definitions/uint8
    minimum: 1
    default: 1
    maximum: 255

  dma-ch:
    description: Maximum number of DMA channel that can be configured
    $ref: /schemas/types.yaml#/definitions/uint32
    type: integer
    minimum: 1
    default: 8
    maximum: 32

  max-ch-mem:
    description: Maximum memory allocated to channels
    $ref: /schemas/types.yaml#/definitions/uint32
    type: integer
    minimum: 1
    default: 131072
    minimum: 131072
    maximum: 2147483647

  ddr-addr:
    description: BAR2 DDR address
    $ref: /schemas/types.yaml#/definitions/uint64
    type: integer
    minimum: 1
    default: 34359738368
    maximum: 34359738368

  ddr-size:
    description: BAR2 DDR size
    $ref: /schemas/types.yaml#/definitions/uint64
    type: integer
    minimum: 1
    default: 8589934592
    maximum: 8589934592

  dma-ll-addr:
    description: Link List for DMA, in DDR address
    $ref: /schemas/types.yaml#/definitions/uint64
    type: integer
    minimum: 0
    maximum: 4294967295

  dma-ll-size:
    description: Link List for DMA, in DDR size
    $ref: /schemas/types.yaml#/definitions/uint64
    type: integer
    minimum: 0
    maximum: 2147483647

  hdma-reg-addr:
    description: HDMA reg address
    $ref: /schemas/types.yaml#/definitions/uint32
    type: integer
    minimum: 0
    maximum: 4294967295

  hdma-reg-size:
    description: HDMA reg size
    $ref: /schemas/types.yaml#/definitions/uint32
    type: integer
    minimum: 0
    maximum: 524287

  ep-off-addr:
    description: Endpoint Offset Addr
    $ref: /schemas/types.yaml#/definitions/uint64
    type: integer
    minimum: 0
    maximum: 16777215

  ep-off-size:
    description: Endpoint Offset Size
    $ref: /schemas/types.yaml#/definitions/uint64
    type: integer
    minimum: 0
    maximum: 262143

  max-functions:
    description: Maximum number of functions that can be configured
    $ref: /schemas/types.yaml#/definitions/uint8
    type: integer
    minimum: 1
    default: 1
    maximum: 255

  max-link-speed:
    $ref: /schemas/types.yaml#/definitions/uint32
    enum: [ 1, 2, 3, 4 ]

  num-lanes:
    description: maximum number of lanes
    $ref: /schemas/types.yaml#/definitions/uint32
    type: integer
    minimum: 1
    default: 1
    maximum: 16

required:
  - compatible
  - reg
  - reg-names
  - dma-coherent
  - num-lanes
  - status

additionalProperties: false
